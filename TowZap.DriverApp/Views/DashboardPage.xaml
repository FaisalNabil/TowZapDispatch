<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:TowZap.DriverApp.ViewModels"
             x:Class="TowZap.DriverApp.Views.DashboardPage"
             Title="Dashboard">

    <Grid>
        <!-- 🔃 Main Scroll Content -->
        <ScrollView>
            <VerticalStackLayout Padding="20" Spacing="20">

                <!-- 👤 User Info -->
                <Label Text="{Binding FullName}" FontSize="22" FontAttributes="Bold" HorizontalOptions="Center" />
                <Label Text="{Binding CompanyName}" FontSize="16" TextColor="Gray" HorizontalOptions="Center" />
                <Label Text="{Binding Role}" FontSize="14" TextColor="DarkBlue" HorizontalOptions="Center" />

                <!-- 🚚 DRIVER SECTION -->
                <Frame IsVisible="{Binding IsDriver}" BorderColor="Gray" Padding="10">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Driver Dashboard" FontSize="18" FontAttributes="Bold" />

                        <!-- ✅ Active Job -->
                        <Frame IsVisible="{Binding HasActiveJob}" BorderColor="LightGray" Padding="10">
                            <VerticalStackLayout>
                                <Label Text="Pickup:" FontAttributes="Bold" />
                                <Label Text="{Binding FromAddress}" FontSize="14" />

                                <Label Text="Dropoff:" FontAttributes="Bold" />
                                <Label Text="{Binding ToAddress}" FontSize="14" />

                                <Label Text="Status:" FontAttributes="Bold" />
                                <Label Text="{Binding CurrentJob.Status}" />

                                <Button Text="View Job Details" Command="{Binding ViewJobCommand}" />
                            </VerticalStackLayout>
                        </Frame>

                        <Label IsVisible="{Binding NoActiveJob}"
                               Text="You don't have any active jobs right now."
                               FontSize="14"
                               TextColor="Gray"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </Frame>

                <!-- 🛠️ DISPATCHER SECTION -->
                <Frame IsVisible="{Binding IsDispatcher}" BorderColor="Gray" Padding="10">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Dispatcher Dashboard" FontSize="18" FontAttributes="Bold" />
                        <Label Text="Coming soon: Create job, manage assignments." FontSize="14" TextColor="Gray" />
                    </VerticalStackLayout>
                </Frame>

                <!-- 🏢 COMPANY ADMIN SECTION -->
                <Frame IsVisible="{Binding IsCompanyAdmin}" BorderColor="Gray" Padding="10">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Company Admin Dashboard" FontSize="18" FontAttributes="Bold" />
                        <Label Text="Coming soon: User and job insights." FontSize="14" TextColor="Gray" />
                    </VerticalStackLayout>
                </Frame>

            </VerticalStackLayout>
        </ScrollView>

        <!-- 🚨 Job Assignment Popup -->
        <ContentView IsVisible="{Binding IsJobPopupVisible}" BackgroundColor="#80000000" Padding="20">
            <Frame BackgroundColor="White" CornerRadius="10" Padding="20" HorizontalOptions="Center" VerticalOptions="Center">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout HorizontalOptions="Center">
                        <Image Source="alert.png" HeightRequest="24" WidthRequest="24" />
                        <Label Text="New Job Assigned" FontSize="18" FontAttributes="Bold" Margin="5,0,0,0" />
                    </HorizontalStackLayout>

                    <Label Text="{Binding FromAddress}" FontSize="14" />
                    <Label Text="{Binding ToAddress}" FontSize="14" />

                    <Button Text="Accept" BackgroundColor="Green" TextColor="White" Command="{Binding AcceptJobCommand}" />
                    <Button Text="Decline" BackgroundColor="Red" TextColor="White" Command="{Binding DeclineJobCommand}" />
                </VerticalStackLayout>
            </Frame>
        </ContentView>
    </Grid>
</ContentPage>
